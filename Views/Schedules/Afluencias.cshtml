@using Supermarket.Models
@model List<AfluenciasViewModel>
@{
    ViewData["Title"] = "Afluencias";
}

<h1>Afluencias</h1>



 <form asp-action="Afluencias" method="get">
    <p><strong>Search dates</strong></p>
    <div class="row">
        <div class="col-4">
    <label for="dataEmissao" class="control-label ">Data Inicial</label>
    <input type="datetime-local" class="form-control" value="@ViewBag.SearchDataIntervaloInicial" />
        </div>
        <div class="col-4">
    <label for="dataEmissao" class="control-label">Data Final</label>
    <input type="datetime-local" class="form-control" value="@ViewBag.SearchDataIntervaloFinal" />
        </div>
    </div>
    <div class="col-4">
        <label  class="control-label">Limite Afluencia</label>
        <input type="number" class="form-control" value="@ViewBag.SearchLimiteAfluencia" />
    </div>
    

    <div class="mt-3">
        <input class="btn btn-primary" type="submit" value="Search" />
        <a class="btn btn-secondary" asp-action="Afluencias">Cancel</a>
    </div>
</form> 
<div class="accordion   mt-5" id="accordionExample">
    @for (int i = 0; i < Model.Count; i++)
{
        var item = Model[i];
        var accordionId = $"accordion{i}";

        <div class="accordion-item">
            <h2 class="accordion-header" id="h@accordionId">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#@accordionId" aria-expanded="true" aria-controls="@accordionId">
                    @item.Department.NameDepartments
                </button>
            </h2>
            <div id="@accordionId" class="accordion-collapse collapse show" aria-labelledby="h@accordionId" >
                @foreach (var ticket in item.Tickets)
                {
                    <div class="accordion-body">
                        #@ticket.NumeroDaSenha | 
                            
                            @if (ticket.IDDepartments == 0)
                            {
                                <strong> Sem departamento </strong>
                            }
                            else if (ticket.Departments != null)
                            {
                                <strong> @ticket.Departments.NameDepartments </strong>

                                
                            }

                        Emitido em: @ticket.DataEmissao  | Estado:  @(ticket.Estado ? "Atendido" : "Não atendido") | Atendido em: @ticket.DataAtendimento

                        

                    </div>
                   
                }
                
            </div>
        </div>
}
    
</div>
@* 
<table class="table">
    <thead>
        <tr>
            <th>
                Data de Emissão
            </th>
            <th>
                Data de Atendimento
            </th>
            <th>
                Número da Senha
            </th>
            <th>
                Estado
            </th>
            <th>
                Prioritário
            </th>
            <th>
                ID do Departamento
            </th>
            

        </tr>
    </thead>

    <tbody>
        @foreach (var item in Model.)
        {
        <tr>
            <td>
                @Html.DisplayFor(modelItem => item.DataEmissao)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.DataAtendimento)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.NumeroDaSenha)
            </td>
            <td>
                    @(item.Estado ? "Atendido" : "Não atendido")
            </td>
            <td>
                    @(item.Prioritario ? "Sim" : "Não")
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.IDDepartments)
            </td>
            
        </tr>
}
    </tbody>
    </table> *@
<a class="btn btn-secondary mt-5" asp-area="Schedules" asp-action="Index">Voltar atrás</a>